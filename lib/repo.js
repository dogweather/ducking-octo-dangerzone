// Generated by CoffeeScript 1.10.0
(function() {
  var bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  App.Repo = (function() {
    function Repo(repo_spec) {
      this.fetchIssues = bind(this.fetchIssues, this);
      this.fetchData = bind(this.fetchData, this);
      var ref;
      ref = repo_spec.split('/'), this.acct = ref[0], this.name = ref[1];
      this.rawdata = {};
      this.fetchData();
    }

    Repo.prototype.fetchData = function() {
      return App.octo.repos(this.acct, this.name).fetch((function(_this) {
        return function(err, repodata) {
          if (err) {
            return alert(err);
          } else {
            _this.rawdata.repo = repodata;
            return _this.fetchIssues(_this.rawdata.repo);
          }
        };
      })(this));
    };

    Repo.prototype.fetchIssues = function(repo) {
      var one_month_ago;
      one_month_ago = '2015-12-22';
      fetchAll(repo.issues.fetch, {
        state: 'open',
        since: one_month_ago
      }).then((function(_this) {
        return function(openIssues) {
          return _this.rawdata.openIssues = openIssues;
        };
      })(this));
      return fetchAll(repo.issues.fetch, {
        state: 'closed',
        since: one_month_ago
      }).then((function(_this) {
        return function(closedIssues) {
          return _this.rawdata.closedIssues = closedIssues;
        };
      })(this));
    };

    return Repo;

  })();

}).call(this);
